Title: BioCypher graph schema configuration file


##################################   hsa_dmel   ###############################


# ---
# "Named Things"
# ---


#parent types
# 1.1)
position entity:
  represented_as: node
  is_a: biological entity
  input_label: position_entity
  description: >-
      A biological entity that is defined by its position in the genome
  properties:
    taxon_id: int                        # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)
    chr: str
    start: int
    end: int
    source: str
    source_url: str


# 1.2)
coding element:
  represented_as: node
  is_a: position entity
  inherit_properties: true
  input_label: coding_element
  description: >-
      A region of a gene that codes for a protein or peptide
  # properties:
  #   source: str
  #   source_url: str



# 1.3)
non coding element:
  represented_as: node
  is_a: position entity
  inherit_properties: true
  input_label: non_coding_element
  description: >-
      A region of a gene that does not code for a protein or peptide
  properties:
    biological_context: str
    # source: str
    # source_url: str


# Fly:
# The unique ID for a library (or cluster) at Flybase is its FBlc#
# This schema could be used to represent a RNA-seq library, cluster or sample. Flybase uses FBlc# ids for:
#
#                         cluster               single cell
#                         cluster_analysis      single cell
#                         sample                high-throughput expression data
#                         dataset               high-throughput expression data
#                         RNASource library     RNA-seq RPKM
#                         parent library
#
# Flybase has assigned FBlc# ids to Fly Cell Atlas 2 tissues (libraries):
# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#RNA-Seq_RPKM_values_matrix_.28gene_rpkm_matrix_fb_.2A.tsv.gz.29
#
# Fly Cell Atlas 2 data:
#
# Aging Fly Cell Atlas data:
#
# Flybase  data:
# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#High-Throughput_Gene_Expression_.28high-throughput_gene_expression_fb_.2A.tsv.gz.29
# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Single_Cell_RNA-Seq_Gene_Expression_.28scRNA-Seq_gene_expression_fb_.2A.tsv.gz.29
# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#RNA-Seq_RPKM_values_.28gene_rpkm_report_fb_.2A.tsv.gz.29
rnaseq library:
  is_a: entity
  represented_as: node
  inherit_properties: false
  input_label: rnaseq_library
  description: >-
      A library/cluster/sample that is a set of genes and their expression values.
  properties:
    name: str
    experiment_info: str[]
    tissue_info: str[]
    cell_type_id: str                   # cell type ontology id: str should be replaced by an ontology type  @todo
    anatomy_entity_id: [uberon, cl]
    taxon_id: int                        # 7227 for dmel / 9606 for hsa
    source: str
    source_url: str


expression value:
  is_a: entity
  represented_as: edge
  inherit_properties: false
  input_label: expression_value
  source: [transcript, gene]
  target: rnaseq library
  description: >-
    A set of values for numeric estimation of single gene/transcript expression as measured by a given methodology (represented by a library).
  properties:
    value_and_description: list[tuple]]   # this list of tuples is to keep semantics in the DAS context.
                                          # it is (value, description), (value, description),...
                                          # where value is a gene (or transcript) expression value and description is
                                          # an acronym or a term or a text to clarify the expression value: "RPKM", "BIN VALUE", "SPREAD", etc.

    taxon_id: int                        # 7227 for dmel / 9606 for hsa
    source: str
    source_url: str

    #float[]
    #value_description: str[]
                                # This property is mandatory: value_description[i] refers to value[i] for all i.



# 1.4)
genomic variant:
  represented_as: node
  is_a: position entity
  inherit_properties: true
  input_label: genomic_variant
  description: >-
      A genomic variant is a change in one or more sequence of a genome
  # properties:
  #   source: str
  #   source_url: str


# 1.5)
epigenomic port:
  represented_as: node
  is_a: position entity
  inherit_properties: true
  input_label: epigenomic_port
  description: >-
      A region of the genome that is associated with epigenetic modifications
  properties:
    biological_context: str
    # source: str
    # source_url: str
## should also include cell type in hierarchy between epigenetic feature and tissue


# 1.6)
3d genome structure:
  represented_as: node
  is_a: position entity
  inherit_properties: true
  input_label: 3d_genome_structure
  description: >-
      A region of the genome that is associated with 3D genome structure
  # properties:
  #   source: str
  #   source_url: str


# 1.7)
# ontology term:
#   represented_as: node
#   is_a: ontology class
#   input_label: ontology term
#   properties:
#     taxon_id: int    # 7227 for dmel / 9606 for hsa    (To be inherited by all types to identify the organism/species that the type refers to)
#     source: str
#     source_url: str

ontology term:
  is_a: ontology class
  represented_as: node
  input_label: ontology term
  properties:
    id: str
    term_name: str
    description: str
    synonyms: str[]
    source: str
    source_url: str


#child types


# 2.1)
chromosome chain:
  represented_as: node
  is_a: position entity
  inherit_properties: true
  input_label: chromosome_chain
  properties:
    chain_id: str
    next_start: int
    resolution: int
    taxon_id: int    # 7227 for dmel / 9606 for hsa (To be inherited by all types to identify the organism/species that the type refers to)




# coding elements
#
# Human: 
# https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_46/gencode.v46.annotation.gtf.gz 
#
# Maybe the “latest_release” could be better:
# https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/latest_release/gencode.v46.annotation.gtf.gz 
# Fly:
#
# Flybase (FB) gtf: https://ftp.flybase.org/genomes/dmel/current/gtf/  ← it doesn’t list gene/transcript types
#
# this table holds fly genes with the transcript types data:
# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#FBgn_.3C.3D.3E_FBtr_.3C.3D.3E_FBpp_IDs_.28expanded.29_.28fbgn_fbtr_fbpp_expanded_.2A.tsv.29 
#
#
# From Ensembl:
# https://ftp.ensembl.org/pub/current_gtf/drosophila_melanogaster/Drosophila_melanogaster.BDGP6.46.112.gtf.gz
# https://ftp.ensembl.org/pub/current_gtf/drosophila_melanogaster/README 
#
# or:  https://ftp.ebi.ac.uk/ensemblgenomes/pub/metazoa/current/gtf/drosophila_melanogaster/ 
#

# FB summaries come from:
  # https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Best_gene_summaries_.28best_gene_summary.2A.tsv.29

# Human summaries come from NCBI:
  #
#
#
# Adapter: gencode_gene_adapter
#
# 2.2)
gene:
  represented_as: node
  preferred_id: ensemble        # ensembl ids are FB FBgn# ids
  input_label: gene
  is_a: coding element
  inherit_properties: true
  properties:
    gene_name: str        # In FB this is the gene symbol (eg “Clk”) whereas the gene name is “Clock”.
    gene_type: str
    sequence: str         # nucleotide sequence
    synonyms:  str[]
    summary: str          # best available summary of information about a gene
    summary_source: str
    taxon_id: int                        # 7227 for dmel / 9606 for hsa


# Human: 
#
# https://ftp.uniprot.org/pub/databases/uniprot/current_release/knowledgebase/taxonomic_divisions/uniprot_sprot_human.dat.gz
# https://ftp.uniprot.org/pub/databases/uniprot/current_release/knowledgebase/taxonomic_divisions/uniprot_trembl_human.dat.gz 
#
# Fly:
# https://ftp.uniprot.org/pub/databases/uniprot/current_release/knowledgebase/taxonomic_divisions/uniprot_sprot_invertebrates.dat.gz 
# FB gene symbols are suffixed with "_DROME"
#
# Flybase (this is an alternative and it was not transformed to MeTTa):
# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#FBgn_.3C.3D.3E_DB_Accession_IDs_.28fbgn_NAseq_Uniprot_.2A.tsv.29 
# https://ftp.flybase.org/releases/current/precomputed_files/collaborators/ 
#
# 2.3)
protein:
  represented_as: node
  preferred_id: uniprot                
  input_label: protein
  is_a: coding element                # it should not be a “coding element” neither a “non coding element” considering their descriptions
  inherit_properties: true
  properties:
    accessions: str[]
    protein_name: str
    dbxrefs: str[]                    # ids for related dbs and ontologies
    # source: str
    # source_url: str




#        →→→→        same as Gene  type for dmel and hsa (except the adapter)        ←←←←
#
# Human:
# https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_46/gencode.v46.annotation.gtf.gz 
#
# Maybe the “latest_release” could be better:
# https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/latest_release/gencode.v46.annotation.gtf.gz 
# Fly:
#
# Flybase (FB) gtf: https://ftp.flybase.org/genomes/dmel/current/gtf/  ← it doesn’t list gene/transcript types
#
# this table holds fly genes with the transcript types data:
# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#FBgn_.3C.3D.3E_FBtr_.3C.3D.3E_FBpp_IDs_.28expanded.29_.28fbgn_fbtr_fbpp_expanded_.2A.tsv.29 
#
#
# From Ensembl:
# https://ftp.ensembl.org/pub/current_gtf/drosophila_melanogaster/Drosophila_melanogaster.BDGP6.46.112.gtf.gz
# https://ftp.ensembl.org/pub/current_gtf/drosophila_melanogaster/README 
#
# or:  https://ftp.ebi.ac.uk/ensemblgenomes/pub/metazoa/current/gtf/drosophila_melanogaster/ 
#
# Adapter: gencode_transcript_adapter
#
# 2.4)
transcript:
  represented_as: node
  input_label: transcript
  is_a: coding element
  inherit_properties: true
  properties:
    #gene_name: str
    gene: gene                #  to link to gene
    transcript_name: str
    #transcript_id: str
    transcript_type: str
  description: >-
    An RNA synthesized on a DNA or RNA template by an RNA polymerase.
  exact_mappings:
    - SO:0000673
    - SIO:010450
    - WIKIDATA:Q7243183
    - dcid:RNATranscript
  in_subset:
    - model_organism_database



#        →→→→        same as Gene  type for dmel and hsa (except the adapter)                ←←←←
#
# Human:
# https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_46/gencode.v46.annotation.gtf.gz 
#
# Maybe the “latest_release” could be better:
# https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/latest_release/gencode.v46.annotation.gtf.gz 
# Fly:
#
# Flybase (FB) gtf: https://ftp.flybase.org/genomes/dmel/current/gtf/  ← it doesn’t list gene/transcript types
#
# this table holds fly genes with the transcript types data:
# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#FBgn_.3C.3D.3E_FBtr_.3C.3D.3E_FBpp_IDs_.28expanded.29_.28fbgn_fbtr_fbpp_expanded_.2A.tsv.29 
#
#
# From Ensembl:
# https://ftp.ensembl.org/pub/current_gtf/drosophila_melanogaster/Drosophila_melanogaster.BDGP6.46.112.gtf.gz
# https://ftp.ensembl.org/pub/current_gtf/drosophila_melanogaster/README 
#
# or:  https://ftp.ebi.ac.uk/ensemblgenomes/pub/metazoa/current/gtf/drosophila_melanogaster/ 
#
# Adapter: gencode_exon_adapter
#
# 2.5)
exon:
  represented_as: node
  preferred_id: ensemble
  input_label: exon
  is_a: coding element
  inherit_properties: true
  properties:
    gene: gene
    transcript: transcript
    exon_number: int
    #exon_id: str



# ---
# genomic variants

# 3.1)
snp:
  represented_as: node
  input_label: snp
  is_a: genomic variant
  inherit_properties: true
  properties:
    ref: str
    alt: str
    caf_ref: str
    caf_alt: str
  description: >-
    A single nucleotide polymorphism (SNP) is a variation in a single nucleotide that occurs at a specific position in the genome




# 3.2)
structural variant:
  represented_as: node
  input_label: structural_variant
  is_a: genomic variant
  inherit_properties: true
  properties:
      variant_type: str
      evidence: str




# 3.3)
sequence variant:
  represented_as: node
  input_label: sequence_variant
  is_a: genomic variant
  inherit_properties: true
  description: >-
    A change in the nucleotide sequence of a genome compared to a reference sequence.
  properties:
    rsid: str
    ref: str
    alt: str
    raw_cadd_score: float
    phred_score: float






# Human:  to be defined…
#
#
# Fly:
# FB https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Alleles_.3C.3D.3E_Genes_.28fbal_to_fbgn_fb_.2A.tsv.29 
allele:
  represented_as: node
  input_label: allele
  is_a: genomic variant
  inherit_properties: true
  properties:
      #gene: gene
      allele_symbol: str
      taxon_id: int                        # 7227 for dmel / 9606 for hsa
  description: >-
      Different versions of the same variant (in a specific  locus) are called alleles[1, 2]. Most commonly used referring to genes.


# saulo
# Used in the so_adapter.py  for dmel data
gene to allele association:
  is_a: annotation
  inherit_properties: true
  represented_as: edge
  input_label: gene_to_allele
  # output_label: belongs_to
  source: gene
  target: allele
  properties:
    taxon_id: str   # 7227 for dmel

# Human:
#
# The same source for ‘gene” schema
#
# Fly:
#
# The same source for ‘gene” schema
#
# FB’s ncRNA_genes_fb_XXXX_XX.json holds most of data, including genes for each transcript
# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Non-coding_RNAs_.28JSON.29_.28ncRNA_genes_fb_.2A.json.gz.29 
# 4.4)
non coding rna:
  represented_as: node
  input_label: non_coding_rna
  is_a: non coding element
  inherit_properties: true
  properties:
    rna_type: str
    gene_id: str                        # to link things together



# —-------------------------------------------------------------------------------------------------------------------------------------
# Ontologies
# —-------------------------------------------------------------------------------------------------------------------------------------


# http://purl.obolibrary.org/obo/go.owl 
# 5.1)
go:
  is_a: ontology term
  inherit_properties: true
  represented_as: node
  input_label: go
  properties:
    term_name: str
    description: str                # definition
    synonyms: str[]
    subontology: str                # GO “namespaces” (BP, MF, CC)


# Flybase development ontology (FBdv#)
FBdv:
  is_a: ontology term
  represented_as: node
  input_label: FBdv
  inherit_properties: true

# Flybase gross anatomy ontology (FBbt#)
FBbt:
  is_a: ontology term
  represented_as: node
  input_label: FBbt
  inherit_properties: true

# Flybase Controlled Vocabulary ontology (FBcv#)
FBcv:
  is_a: ontology term
  represented_as: node
  input_label: FBcv
  inherit_properties: true

# Molecular interactions ontology (MI)
mi:
  is_a: ontology term
  represented_as: node
  input_label: mi
  inherit_properties: true

# Sequence ontology (SO)
so:
  is_a: ontology term
  represented_as: node
  input_label: so
  inherit_properties: true

# https://purl.obolibrary.org/obo/doid.owl
# disease ontology
do:
  is_a: ontology term
  inherit_properties: true
  represented_as: node
  input_label: do
  # properties:
  #   term_name: str
  #   description: str                        # definition
  #   synonyms: str[]
  #   subsetdef: str[]
  #   xref: str                                #  like dbxref: ids for other databases






# https://bioportal.bioontology.org/ontologies/ECO
#Evidence & Conclusion Ontology


# https://bioportal.bioontology.org/ontologies/MI
#PSI-MI Molecular Interaction Ontology


# https://bioportal.bioontology.org/ontologies/SO
#The Sequence Ontology






# 6.4)
# FB: https://wiki.flybase.org/wiki/FlyBase:ModENCODE_data_at_FlyBase  ← I need to check this
# Where is the human data?


histone modification:
  represented_as: node
  is_a: epigenomic port
  inherit_properties: true
  input_label: histone_modification
  description: >
    A post-translational modification of histone proteins e.g methylation, acetylation, phosphorylation
  properties:
    modification: str
    modification_type: str






# —-------------------------------------------------------------------------------------------------------------------------------------
# Associations
# —-------------------------------------------------------------------------------------------------------------------------------------




#parent types


# 7.1)
expression:
  is_a: related to at instance level
  #inherit_properties: true
  represented_as: edge
  input_label: expression
  description: >-
    An association between a gene and its expression constituents
  source: gene
  target: [transcript, exon, protein]
  properties:
    source: str
    source_url: str
    taxon_id: int                        # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)



# 7.2)
annotation:
  is_a: related to at concept level
  represented_as: edge
  input_label: annotation
  description: >-
    An association between a gene/ontology term and another entity
  properties:
    taxon_id: int                        # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)
    source: str
    source_url: str




# 7.3)
regulatory association:
  is_a: related to at instance level
  #inherit_properties: true
  represented_as: edge
  input_label: regulatory_association
  Source: gene
  properties:
    taxon_id: int                        # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)
    source: str
    source_url: str



# 7.4)
# FB: https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#FBgn_.3C.3D.3E_FBtr_.3C.3D.3E_FBpp_IDs_.28expanded.29_.28fbgn_fbtr_fbpp_expanded_.2A.tsv.29 
transcribed to:
  represented_as: edge
  is_a: expression
  inherit_properties: true
  input_label: transcribed_to
  source: gene
  target: transcript
  description: >-
    inverse of transcribed from
  exact_mappings:
    - RO:0002511
    - SIO:010080




# 7.5)
# FB: https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#FBgn_.3C.3D.3E_FBtr_.3C.3D.3E_FBpp_IDs_.28expanded.29_.28fbgn_fbtr_fbpp_expanded_.2A.tsv.29 
transcribed from:
  is_a: expression
  inherit_properties: true
  represented_as: edge
  input_label: transcribed_from
  source: transcript
  target: gene
  description: >-
    x is transcribed from y if and only if x is synthesized from template y
  exact_mappings:
    - RO:0002510
    - SIO:010081




# 7.6)
# FB: https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#FBgn_.3C.3D.3E_FBtr_.3C.3D.3E_FBpp_IDs_.28expanded.29_.28fbgn_fbtr_fbpp_expanded_.2A.tsv.29 
translates to:
  is_a: expression
  inherit_properties: true
  represented_as: edge
  input_label: translates_to
  source: transcript
  target: protein
  inverse: translation of
  description: >-
    x (amino acid chain/polypeptide) is the ribosomal translation of y (transcript) if and only if a ribosome
    reads y (transcript) through a series of triplet codon-amino acid adaptor activities (GO:0030533)
    and produces x (amino acid chain/polypeptide)
  close_mappings:
    - RO:0002513
    - SIO:010082




# 7.7)
# FB: https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#FBgn_.3C.3D.3E_FBtr_.3C.3D.3E_FBpp_IDs_.28expanded.29_.28fbgn_fbtr_fbpp_expanded_.2A.tsv.29 
translation of:
  is_a: expression
  inherit_properties: true
  represented_as: edge
  input_label: translation_of
  source: protein
  target: transcript
  description: >-
    inverse of translates to
  inverse: translates to
  close_mappings:
    - RO:0002512
    - SIO:010083




# 7.9)
# These files list         protein1_id        protein2_id        combined_score
# dmel: https://stringdb-downloads.org/download/protein.links.v12.0/7227.protein.links.v12.0.txt.gz 
# hsa:  https://stringdb-downloads.org/download/protein.links.v12.0/9606.protein.links.v12.0.txt.gz 
post translational interaction:
  is_a: expression
  inherit_properties: true
  represented_as: edge
  input_label: interacts_with
  source: protein
  target: protein
  properties:
    score: float    # STRING DB score    
    source_gene: gene       
    target_gene: gene       
    detection_method: mi    # Molecular Interaction Ontology
    pubmed_ids: str[]
    source_taxon_id: int
    target_taxon_id: int
    interaction_type: mi    # Molecular Interaction Ontology
    interaction_comments: str
    source_comments: str
    target_comments: str    


# Schema for RNA-protein and protein-protein interactions (there are 3349 RNA-prot and RNA-RNA interactions in the FB_2024_05 FB release) and protein-protein a
# Biocypher doesn't accept source AND targets as lists of types in the same schema
# # ptp stands for "protein or transcript to protein"
ptp physically interacts with:
  is_a: expression
  inherit_properties: true
  represented_as: edge
  input_label: ptp_physically_interacts_with
  source: [protein, transcript]
  target: protein
  properties:
    source_gene: gene       
    target_gene: gene       
    detection_method: mi    # Molecular Interaction Ontology
    pubmed_ids: str[]
    source_taxon_id: int
    target_taxon_id: int
    interaction_type: mi    # Molecular Interaction Ontology
    interaction_comments: str
    source_comments: str
    target_comments: str    


# Schema for protein-RNA and RNA-RNA interactions  (there are 3349 such interactions in the FB_2024_05 FB release)   physical interaction:
# ptt stands for "protein or transcript to transcript"
ptt physically interacts with:
  is_a: expression
  inherit_properties: true
  represented_as: edge
  input_label: ptt_physically_interacts_with
  source: [protein, transcript]
  target: transcript   
  properties:
    source_gene: gene       
    target_gene: gene       
    detection_method: mi    # Molecular Interaction Ontology
    pubmed_ids: str[]
    source_taxon_id: int
    target_taxon_id: int
    interaction_type: mi    # Molecular Interaction Ontology
    interaction_comments: str
    source_comments: str
    target_comments: str    


# 7.23)
# This holds data from TFLink to fly: https://cdn.netbiol.org/tflink/download_files/TFLink_Drosophila_melanogaster_interactions_All_simpleFormat_v1.0.tsv 
transcription factor to gene association:
  description: >-
    An regulatory association between a transcription factor and its target gene
  is_a: regulatory association
  inherit_properties: true
  represented_as: edge
  input_label: tf_gene
  output_label: regulates
  source: gene
  target: gene
  properties:
    evidence: str[]
    detection_method: str
    databases: str[]
    evidence_type: str


# Dmel to hsa data:

  #                   *** THE TABLE ONLY REPORTS HOMOLOGY WITH DIOPT SCORE GREATER THAN 2 ***
  #                   https://fgr.hms.harvard.edu/diopt-documentation

# From FB:  https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Human_Orthologs_.28dmel_human_orthologs_disease_fb_.2A.tsv.gz.29
# FB table columns:
##Dmel_gene_ID	Dmel_gene_symbol	Human_gene_HGNC_ID	Human_gene_OMIM_ID	Human_gene_symbol	DIOPT_score	OMIM_Phenotype_IDs	OMIM_Phenotype_IDs[name]
orthology association:
  description: >-
  Non-directional association between two genes indicating that there is an orthology relation among them:  “Historical homology that involves genes that diverged after a speciation event (http://purl.obolibrary.org/obo/RO_HOM0000017)"
  is_a: related to at instance level
  #inherit_properties: true
  represented_as: edge
  input_label: orthologs_genes
  source: gene
  target: gene
  properties:
    DIOPT_score: int
    hsa_hgnc_id: str
    hsa_omim_id: str
    hsa_omim_phenotype_ids: str
    hsa_omim_phenotype_ids_names: str
    source_organism: str
    target_organism: str
    #taxon_id: int                        # 7227 for dmel / 9606 for hsa




# Human:
#
# Fly:
#
# From FB:  https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Drosophila_Paralogs_.28dmel_paralogs_fb_.2A.tsv.gz.29

  #                   *** THE TABLE ONLY REPORTS HOMOLOGY WITH DIOPT SCORE GREATER THAN 2 ***
  #                   https://fgr.hms.harvard.edu/diopt-documentation

# FB table columns:
## FBgn_ID	GeneSymbol	Arm/Scaffold	Location	Strand	Paralog_FBgn_ID	Paralog_GeneSymbol	Paralog_Arm/Scaffold	Paralog_Location	Paralog_Strand	DIOPT_score
paralogy association:
  description: >-
  Non-directional association between two genes indicating that there is an paralogy relation among them:  “Historical homology that involves genes that diverged after a duplication event (http://purl.obolibrary.org/obo/RO_HOM0000011)"
  is_a: related to at instance level
  #inherit_properties: true
  represented_as: edge
  input_label: paralogs_genes
  source: gene
  target: gene
  properties:
    source_symbol: str
    target_symbol: str
    DIOPT_score: int
    taxon_id: int                        # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)




####################################   hsa   ##################################



# ---
# non-coding elements


# 4.1)
enhancer:
  represented_as: node
  input_label: enhancer
  is_a: non coding element
  inherit_properties: true
  properties:
    data_source: str
    taxon_id: int                        # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)



# 4.2)
promoter:
  represented_as: node
  input_label: promoter
  is_a: non coding element
  inherit_properties: true
  properties:
    taxon_id: int                        # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)



# 4.3)
super enhancer:
  represented_as: node
  input_label: super_enhancer
  is_a: non coding element
  inherit_properties: true
  properties:
    taxon_id: int                        # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)



# 4.5)
pathway:
  is_a: biological process
  exact_mappings:
    - PW:0000001
    - WIKIDATA:Q4915012
  narrow_mappings:
    - SIO:010526
    - GO:0007165
  represented_as: node
  input_label: pathway
  properties:
    taxon_id: int                        # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)
    pathway_name: str
    evidence: str


# 4.6)
regulatory region:
  represented_as: node
  input_label: regulatory_region
  is_a: non coding element
  inherit_properties: true
  description: >-
    A region of the genome that is involved in gene regulation.
  properties:
    cell: str
    biochemical_activity: str
    biological_context: str




# 5.2)
motif:                                
  represented_as: node
  is_a: epigenomic port
  inherit_properties: true
  input_label: motif
  accessible_via:
    name: motifs
    description: 'TF binding motifs.'
    fuzzy_text_search: tf_name
    return: _id, tf_name, source, source_url, pwm, length
  properties:
    tf_name: str
    pwm_A: float[]
    pwm_C: float[]
    pwm_G: float[]
    pwm_T: float[]
    length: str




# ---
# 3D genome structures


# 6.1)
tad:
  represented_as: node
  input_label: tad
  is_a: 3d genome structure
  inherit_properties: true
  properties:
        genes: str[]




# 6.2)
chromatin state:
  represented_as: node
  is_a: epigenomic port
  inherit_properties: true
  input_label: chromatin_state
  properties:
    state: str




# 6.3)
dnase hypersensitivity site:
  represented_as: node
  is_a: epigenomic port
  inherit_properties: true
  input_label: dnase_hypersensitivity_site
  description: >-
    A region of chromatin that is sensitive to cleavage by the enzyme DNase I



# —-------------------------------------------------------------------------------------------------------------------------------------
# Associations
# —-------------------------------------------------------------------------------------------------------------------------------------




# 7.8)
gene to gene coexpression association:
  description: >-
    Indicates that two genes are co-expressed, generally under the same conditions.
  is_a: expression
  inherit_properties: true
  represented_as: edge
  input_label: coexpressed_with
  source: gene
  target: gene
  properties:
    score: float




# ---
# annotation


# 7.10)
gene to pathway association:
  description: >-
    An interaction between a gene or gene product and a biological process or pathway.
  is_a: annotation
  inherit_properties: true
  represented_as: edge
  input_label: genes_pathways
  source: [gene, protein, transcript]
  #source: gene
  target: pathway


# 7.11)
parent pathway of:
    is_a: annotation
    inherit_properties: true
    description: >-
      holds between two pathways where the domain class is a parent pathway of the range class
    represented_as: edge
    input_label: parent_pathway_of
    source: pathway
    target: pathway


# 7.12)
child pathway of:
    is_a: annotation
    inherit_properties: true
    description: >-
      holds between two pathways where the domain class is a child pathway of the range class
    represented_as: edge
    input_label: child_pathway_of
    source: pathway
    target: pathway



subclass of:
  is_a: annotation
  inherit_properties: true
  represented_as: edge
  input_label: subclass_of
  source: ontology term
  target: ontology term
  properties:
    rel_type: str


# 7.13)
go subclass of:
  is_a: subclass of
  inherit_properties: true
  represented_as: edge
  input_label: go_subclass_of
  output_label: subclass_of
  source: go
  target: go


# go subclass of:
#   is_a: annotation
#   inherit_properties: ffalse
#   represented_as: edge
#   input_label: go_subclass_of
#   output_label: subclass_of
#   source: go
#   target: go


FBdv subclass of:
  is_a: subclass of
  inherit_properties: true
  represented_as: edge
  input_label: FBdv_subclass_of
  output_label: subclass_of
  source: FBdv
  target: FBdv

FBbt subclass of:
  is_a: subclass of
  inherit_properties: true
  represented_as: edge
  input_label: FBbt_subclass_of
  output_label: subclass_of
  source: FBbt
  target: FBbt

FBcv subclass of:
  is_a: subclass of
  inherit_properties: true
  represented_as: edge
  input_label: FBcv_subclass_of
  output_label: subclass_of
  source: FBcv
  target: FBcv

mi subclass of:
  is_a: subclass of
  inherit_properties: true
  represented_as: edge
  input_label: mi_subclass_of
  output_label: subclass_of
  source: mi
  target: mi

so subclass of:
  is_a: subclass of
  inherit_properties: true
  represented_as: edge
  input_label: so_subclass_of
  output_label: subclass_of
  source: so
  target: so

do subclass of:
  is_a: subclass of
  inherit_properties: true
  represented_as: edge
  input_label: do_subclass_of
  output_label: subclass_of
  source: do
  target: do

# 7.14)
# saulo
# Used in the GAFAdapter for human data
go gene product:
  is_a: annotation
  inherit_properties: true
  represented_as: edge
  input_label: go_gene_product
  source: protein
  target: go
  properties:
    qualifier: obj
    db_reference: obj
    evidence: str




# 7.15)
# Used in the GAFAdapter  for dmel data - comment by saulo
go gene:
  is_a: annotation
  inherit_properties: true
  represented_as: edge
  input_label: go_gene
  output_label: belongs_to
  source: gene
  target: go
  properties:
    qualifier: obj
    db_reference: obj
    evidence: str

# saulo
# Used in the so_adapter.py  for dmel data
gene to so:
  is_a: annotation
  inherit_properties: true
  represented_as: edge
  input_label: gene_to_so
  # output_label: belongs_to
  source: gene
  target: so
  properties:
    taxon_id: str   # 7227 for dmel



# 7.16)
go rna:
  is_a: annotation
  inherit_properties: true
  represented_as: edge
  input_label: go_rna
  output_label: belongs_to
  source: non coding rna
  target: go




# 7.17)
ontology has part:
  is_a: annotation
  inherit_properties: true
  represented_as: edge
  input_label: ontology_has_part
  output_label: has_part
  source: ontology term
  target: ontology term




# 7.18)
ontology part of:
  is_a: annotation
  inherit_properties: true
  represented_as: edge
  input_label: ontology_part_of
  output_label: part_of
  source: ontology term
  target: ontology term




# 7.19)
ontology subclass of:
  is_a: annotation
  inherit_properties: true
  represented_as: edge
  input_label: ontology_subclass_of
  output_label: subclass_of
  source: ontology term
  target: ontology term
  properties:
    rel_type: str


# ---
# regulatory association


# 7.20)
enhancer to gene association:
  description: >-
    An association between an enhancer and a gene
  is_a: regulatory association
  inherit_properties: true
  represented_as: edge
  input_label: enhancer_gene
  output_label: regulates
  source: enhancer
  target: gene
  properties:
    score: float
    biological_context: str




# 7.21)
promoter to gene association:
  description: >-
      An association between a promoter and a gene
  is_a: regulatory association
  inherit_properties: true
  represented_as: edge
  input_label: promoter_gene
  output_label: regulates
  source: promoter
  target: gene
  properties:
      score: float
      biological_context: str




# 7.22)
super enhancer to gene association:
  description: >-
    An association between a super enhancer and a gene
  is_a: regulatory association
  inherit_properties: true
  represented_as: edge
  input_label: super_enhancer_gene
  output_label: regulates
  source: super enhancer
  target: gene
  properties:
    score: float
    biological_context: str






# 7.24)
regulatory region to gene association:
  description: >-
    An association between a regulatory region and a gene it regulates
  is_a: regulatory association
  inherit_properties: true
  represented_as: edge
  input_label: regulatory_region_gene
  output_label: regulates
  source: regulatory_region
  target: gene
  properties:
    abc_score: float
    biological_context: str






# 7.25)
gtex variant to gene expression association:
  aliases: [ 'eQTL', 'e-QTL']
  description: >-
    An association between a variant and expression of a gene (i.e. e-QTL)
  is_a: related to at instance level
  represented_as: edge
  input_label: gtex_variant_gene
  output_label: correlates_with
  source: snp
  target: gene
  properties:
    taxon_id: int                        # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)
    slope: float
    maf: float
    p_value: float
    q_value: float
    biological_context: str
    source: str
    source_url: str




# 7.26)
closest gene to variant association:
  is_a: related to at instance level
  description: >-
    holds between a sequence variant and a gene that is closest to the variant
  represented_as: edge
  input_label: closest_gene
  source: snp
  target: gene
  properties:
    taxon_id: int                        # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)
    chr: str
    pos: int
    distance: int
    source: str
    source_url: str




# 7.27)
upstream gene to variant association:
  is_a: closest gene to variant association
  inherit_properties: true
  description: >-
    holds between a sequence variant and a gene that is upstream to the variant
  represented_as: edge
  input_label: upstream_gene
  source: snp
  target: gene




# 7.28)
downstream gene to variant association:
  is_a: closest gene to variant association
  inherit_properties: true
  description: >-
      holds between a sequence variant and a gene that is downstream to the variant
  represented_as: edge
  input_label: downstream_gene
  source: snp
  target: gene




# 7.29)
in gene to variant association:
  is_a: closest gene to variant association
  inherit_properties: true
  description: >-
    holds between a sequence variant and a gene that is within the gene body
  represented_as: edge
  input_label: in_gene
  source: snp
  target: gene


# 7.30)
topld in linkage disequilibrium with:
  is_a: related to at instance level
  description: holds between two sequence variants, the presence of which are correlated
    in a population
  represented_as: edge
  input_label: in_ld_with
  source: snp
  target: snp
  properties:
    taxon_id: int                        # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)
    ancestry: str
    r2: float
    d_prime: float
    source: str
    source_url: str


# 7.31)
lower resolution structure:
  is_a: related to at instance level
  description: >-
    holds between two chromosome chains where one is a lower resolution version of the other
  represented_as: edge
  input_label: lower_resolution
  source: chromosome_chain
  target: chromosome_chain
  properties:
    taxon_id: int                        # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)


# 7.32)
located on chain:
  is_a: related to at instance level
  description: >-
    holds between a position entity and a chromosome chain
  represented_as: edge
  input_label: located_on_chain
  source: position_entity
  target: chromosome_chain
  properties:
    taxon_id: int                        # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)





####################################   dmel  ##################################




# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Gene_f_data_.28gene_group_data_fb_.2A.tsv.29
# id is FBgg# for Flybase data
gene group:
  represented_as: node
  input_label: gene_group
  is_a: biological entity
  properties:
    genes: gene[]            # FBgn# list to link the group
    group_symbol: str
    group_name: str
    parent_groups: gene group[]        # FBgg#
    parent_groups_symbols: str[]
    HGNC_family_ID: str        # https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Gene_groups_with_HGNC_IDs_.28gene_groups_HGNC_fb_.2A.tsv.29
    taxon_id: int               # 7227 for dmel / 9606 for hsa


# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Pathway_group_data_.28pathway_group_data_fb_.2A.tsv.29
# id is FBgg# for Flybase data
pathway gene group:
  represented_as: node
  input_label: pathway_gene_group
  is_a: biological entity
  properties:
    taxon_id: int               # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)
    genes: gene[]               # FBgn# list to link the group
    group_symbol: str
    group_name: str
    parent_groups: pathway gene group[]        # FBgg#
    parent_groups_symbols: str[]
    HGNC_family_ID: str        # https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Gene_groups_with_HGNC_IDs_.28gene_groups_HGNC_fb_.2A.tsv.29


# FB data: https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Human_disease_model_data_.28disease_model_annotations_fb_.2A.tsv.gz.29
disease model:
  represented_as: node
  input_label: disease_model
  is_a: biological entity
  properties:
    taxon_id: int                        # 7227 for dmel / 9606 for hsa    (TO BE INHERITED BY ALL TYPES)
    gene: gene        
    do_qualifier: str
    do_term_id: str                       # only this should be enough because of DiseaseOntology
    do_term_name: str
    allele: allele
    ortholog_hgnc_id: str
    ortholog_hgnc_symbol: str             # this should be linked to in the Gene data type
    evidence_code: str                    # evidence code and interacting alleles are in the same field (column) in the tsv file
    interacting_alleles: allele[]         # but they occur *together* very infrequently
    ev_code_interact_alleles: str
    reference_FBrf_id: str


# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Phenotypic_data_.28genotype_phenotype_data_.2A.tsv.29

# For Flybase data this should be a link between a set (list) of allele ids representing the genotype and a set(list)
# of phenotypes ids. Of course, we could create a link from Gene to Phenotype (like Monarch) because of the natural
# relationship between a gene and its alleles.
genotype phenotype:
  represented_as: node
  input_label: genotype_phenotype
  is_a: biological entity

  properties:
    genotype_FBids: str
    genotype_symbols: str       # string composed of one or more allele symbol(s)
    phenotype_term_id: [FBbt, FBcv]           # The Flybase Anatomy id (FBbt#)  or Flybase Controlled Vocabulary id (FBcv#)
    phenotype_term_name: str
    qualifier_term_names: str[]
    qualifier_term_ids: list[tuple]         # zero or more FBcv# and/or FBdv# to add information to the phenotype.
                                            # format: [('FBdv', FBdv:XXXXXXX), ('FBbt', FBbt:YYYYYYY)]
    reference: str                          # FBrf# FB flistliterature ref id
    taxon_id: int                        # 7227 for dmel / 9606 for hsa


# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Phenotypic_data_.28genotype_phenotype_data_.2A.tsv.29
#phenotype:
#  represented_as: node
#  input_label: phenotype
#  is_a: annotation
#  inherit_properties: true
#  properties:
#    name: str
#    qualifier_ids: str[]               # zero or more FBcv# and/or FBdv# to add information to the phenotype
#    qualifier_names: str[]
#    reference: str                     # FBrf#




# —-------------------------------------------------------------------------------------------------------------------------------------
# Associations
# —-------------------------------------------------------------------------------------------------------------------------------------


# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Genetic_interaction_table_.28gene_genetic_interactions_.2A.tsv.29
gene genetic association:
  description: >-
    An association between a gene and another gene, i.e., a gene-level genetic interactions in FlyBase. This data is computed from the allele-level genetic interaction data captured by FlyBase curators.
  is_a: regulatory association
  inherit_properties: true
  represented_as: edge
  input_label: gene_genetic_association
  source: gene
  target: gene
  properties:
    reference: str              # FBrf#
    type: str                # suppresses (“suppressible”) / enhances (“enhanceable”)
    taxon_id: int                        # 7227 for dmel / 9606 for hsa



# https://wiki.flybase.org/wiki/FlyBase:Downloads_Overview#Genetic_interactions_.28allele_genetic_interactions_.2A.tsv.29

  # In this first version, the interaction description ia stored in the node that is identified by a string that works
  # like a "primary key": "allele_genetic_interaction_0", "allele_genetic_interaction_1", "allele_genetic_interaction_2",...
  #
  # TODO:
  # In the next iteration, this class will extract any allele symbol occuring in an "interaction" text and will br created
  # an edge from the "source allele" given by this node and the allele corresponding to  any allele symbol in the interaction text.
allele genetic interaction:
  description: >-
    An allelic interaction is a controlled vocabulary (i.e. not free text) genetic interaction data associated with alleles.
  #is_a: annotation
  is_a: biological entity
  #inherit_properties: true
  represented_as: node
  input_label: allele_genetic_interaction
  #source: allele
  #target: annotation                        # FB Controlled Vocabulary-based text
  properties:
  
    allele_id: str
    interaction_text: str                    # FB Controlled Vocabulary-based text
    source: str
    source_url: str






# —-------------------------------------------------------------------------------------------------------------------------------------
# Ontologies
# —-------------------------------------------------------------------------------------------------------------------------------------


# https://bioportal.bioontology.org/ontologies/FB-BT	The Flybase Anatomy


# https://bioportal.bioontology.org/ontologies/FB-DV	The Flybase Developmen	


# https://bioportal.bioontology.org/ontologies/FB-CV 	The Flybase Controlled Vocabulary


# https://www.enzyme-database.org/downloads.php 	ExplorEnz - The Enzyme Database 
